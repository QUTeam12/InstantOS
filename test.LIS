                         4 .list
                         5 ***************************************************************
                         6 ** å„ç¨®ãƒ¬ã‚¸ã‚¹ã‚¿å®šç¾©
                         7 ***************************************************************
                         8 ***************
                         9 ** ãƒ¬ã‚¸ã‚¹ã‚¿ç¾¤ã®å…ˆé ­
                        10 ***************
                        11 .equ REGBASE, 0xFFF000 | DMAP ã‚’ä½¿ç”¨ï¼
                        12 .equ IOBASE, 0x00d00000
                        13 ***************
                        14 ** å‰²ã‚Šè¾¼ã¿é–¢ä¿‚ã®ãƒ¬ã‚¸ã‚¹ã‚¿
                        15 ***************
                        16 .equ IVR, REGBASE+0x300 | å‰²ã‚Šè¾¼ã¿ãƒ™ã‚¯ã‚¿ãƒ¬ã‚¸ã‚¹ã‚¿
                        17 .equ IMR, REGBASE+0x304 | å‰²ã‚Šè¾¼ã¿ãƒã‚¹ã‚¯ãƒ¬ã‚¸ã‚¹ã‚¿
                        18 .equ ISR, REGBASE+0x30c | å‰²ã‚Šè¾¼ã¿ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒ¬ã‚¸ã‚¹ã‚¿
                        19 .equ IPR, REGBASE+0x310 | å‰²ã‚Šè¾¼ã¿ãƒšãƒ³ãƒ‡ã‚£ãƒ³ã‚°ãƒ¬ã‚¸ã‚¹ã‚¿
                        20 ***************
                        21 ** ã‚¿ã‚¤ãƒé–¢ä¿‚ã®ãƒ¬ã‚¸ã‚¹ã‚¿
                        22 ***************
                        23 .equ TCTL1, REGBASE+0x600 | ã‚¿ã‚¤ãƒï¼‘ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ãƒ¬ã‚¸ã‚¹ã‚¿
                        24 .equ TPRER1, REGBASE+0x602 | ã‚¿ã‚¤ãƒï¼‘ãƒ—ãƒªã‚¹ã‚±ãƒ¼ãƒ©ãƒ¬ã‚¸ã‚¹ã‚¿
                        25 .equ TCMP1, REGBASE+0x604 | ã‚¿ã‚¤ãƒï¼‘ã‚³ãƒ³ãƒšã‚¢ãƒ¬ã‚¸ã‚¹ã‚¿
                        26 .equ TCN1, REGBASE+0x608 | ã‚¿ã‚¤ãƒï¼‘ã‚«ã‚¦ãƒ³ã‚¿ãƒ¬ã‚¸ã‚¹ã‚¿
                        27 .equ TSTAT1, REGBASE+0x60a | ã‚¿ã‚¤ãƒï¼‘ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒ¬ã‚¸ã‚¹ã‚¿
                        28 ***************
                        29 ** UART1ï¼ˆé€å—ä¿¡ï¼‰é–¢ä¿‚ã®ãƒ¬ã‚¸ã‚¹ã‚¿
                        30 ***************
                        31 .equ USTCNT1, REGBASE+0x900 | UART1 ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹/ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ãƒ¬ã‚¸ã‚¹ã‚¿
                        32 .equ UBAUD1, REGBASE+0x902 | UART1 ãƒœãƒ¼ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ãƒ¬ã‚¸ã‚¹ã‚¿
                        33 .equ URX1, REGBASE+0x904 | UART1 å—ä¿¡ãƒ¬ã‚¸ã‚¹ã‚¿
                        34 .equ UTX1, REGBASE+0x906 | UART1 é€ä¿¡ãƒ¬ã‚¸ã‚¹ã‚¿
                        35 ***************
                        36 ** LED
                        37 ***************
                        38 .equ LED7, IOBASE+0x000002f | ãƒœãƒ¼ãƒ‰æ­è¼‰ã® LED ç”¨ãƒ¬ã‚¸ã‚¹ã‚¿
                        39 .equ LED6, IOBASE+0x000002d | ä½¿ç”¨æ³•ã«ã¤ã„ã¦ã¯ä»˜éŒ² A.4.3.1
                        40 .equ LED5, IOBASE+0x000002b
                        41 .equ LED4, IOBASE+0x0000029
                        42 .equ LED3, IOBASE+0x000003f
                        43 .equ LED2, IOBASE+0x000003d
                        44 .equ LED1, IOBASE+0x000003b
                        45 .equ LED0, IOBASE+0x0000039
                        46 **************
                        47 ** æ¨å¥¨å€¤
                        48 **************
                        49 .equ Mask_None,       0xFF3FFF
                        50 .equ Mask_UART1,      0xFF3FFB
                        51 .equ Mask_UART1_Timer,0xFF3FF9
                        52 **Timer
                        53 
                        54 **UART1
                        55 .equ U_Reset,   0x0000
                        56 .equ U_Putpull, 0xE100
                        57 .equ U_Putonly, 0xE108
                        58 .equ U_Pullonly,0xE10C
                        59 ***************************************************************
                        60 ** ã‚¹ã‚¿ãƒƒã‚¯é ˜åŸŸã®ç¢ºä¿
                        61 ***************************************************************
                        62 .section .bss
                        63 .even
000708 0000 0000        64 SYS_STK:.ds.b 0x4000 | ã‚·ã‚¹ãƒ†ãƒ ã‚¹ã‚¿ãƒƒã‚¯é ˜åŸŸ
       0000 0000        64 
       0000 0000        64 
       0000 0000        64 
       0000 0000        64 
                        65 .even
                        66 SYS_STK_TOP: | ã‚·ã‚¹ãƒ†ãƒ ã‚¹ã‚¿ãƒƒã‚¯é ˜åŸŸã®æœ€å¾Œå°¾
                        67 *****************************************************************
                        68 **ã‚­ãƒ¥ãƒ¼
                        69 *****************************************************************
004708 0000 0000        70 top0:		.ds.b	255			/*ã‚­ãƒ¥ãƒ¼ã®æˆ¦é—˜ã®ç•ªåœ°*/
       0000 0000        70 
       0000 0000        70 
       0000 0000        70 
       0000 0000        70 
004807 00               71 bottom0:	.ds.b	1			/*ã‚­ãƒ¥ãƒ¼ã®æœ«å°¾ã®ç•ªåœ°*/
004808 0000 0000        72 out0:		.ds.l	1			/*æ¬¡ã«å–ã‚Šå‡ºã™ãƒ‡ãƒ¼ã‚¿ã®ã‚ã‚‹ç•ªåœ°*/
00480c 0000 0000        73 in0:		.ds.l	1 			/*æ¬¡ã«ãƒ‡ãƒ¼ã‚¿ã‚’å…¥ã‚Œã‚‹ã¹ãç•ªåœ°*/
004810 0000 0000        74 s0:		.ds.l	1			/*ã‚­ãƒ¥ãƒ¼ã«æºœã¾ã£ã¦ã„ã‚‹ãƒ‡ãƒ¼ã‚¿ã®æ•°*/
                        75 
004814 0000 0000        76 top1:		.ds.b	255			/*ã‚­ãƒ¥ãƒ¼ã®æˆ¦é—˜ã®ç•ªåœ°*/
       0000 0000        76 
       0000 0000        76 
       0000 0000        76 
       0000 0000        76 
004913 00               77 bottom1:	.ds.b	1			/*ã‚­ãƒ¥ãƒ¼ã®æœ«å°¾ã®ç•ªåœ°*/
004914 0000 0000        78 out1:		.ds.l	1			/*æ¬¡ã«å–ã‚Šå‡ºã™ãƒ‡ãƒ¼ã‚¿ã®ã‚ã‚‹ç•ªåœ°*/
004918 0000 0000        79 in1:		.ds.l	1 			/*æ¬¡ã«ãƒ‡ãƒ¼ã‚¿ã‚’å…¥ã‚Œã‚‹ã¹ãç•ªåœ°*/
00491c 0000 0000        80 s1:		.ds.l	1			/*ã‚­ãƒ¥ãƒ¼ã«æºœã¾ã£ã¦ã„ã‚‹ãƒ‡ãƒ¼ã‚¿ã®æ•°*/
                        81 	
004920 0000 0000        82 out_data:	 .ds.l 	300
       0000 0000        82 
       0000 0000        82 
       0000 0000        82 
       0000 0000        82 
004dd0 0000 0000        83 out_status:	 .ds.l 	300
       0000 0000        83 
       0000 0000        83 
       0000 0000        83 
       0000 0000        83 
005280 0000 0000        84 in_status:	 .ds.l 	300
       0000 0000        84 
       0000 0000        84 
       0000 0000        84 
       0000 0000        84 
005730 0000 0000        85 in_data:	 .ds.l	300
       0000 0000        85 
       0000 0000        85 
       0000 0000        85 
       0000 0000        85 
                        86 
                        87 ***************************************************************
                        88 ** åˆæœŸåŒ–
                        89 ** å†…éƒ¨ãƒ‡ãƒã‚¤ã‚¹ãƒ¬ã‚¸ã‚¹ã‚¿ã«ã¯ç‰¹å®šã®å€¤ãŒè¨­å®šã•ã‚Œã¦ã„ã‚‹ï¼
                        90 ** ãã®ç†ç”±ã‚’çŸ¥ã‚‹ã«ã¯ï¼Œä»˜éŒ² B ã«ã‚ã‚‹å„ãƒ¬ã‚¸ã‚¹ã‚¿ã®ä»•æ§˜ã‚’å‚ç…§ã™ã‚‹ã“ã¨ï¼
                        91 ***************************************************************
                        92 .section .text
                        93 .even
                        94 boot: * ã‚¹ãƒ¼ãƒ‘ãƒ¼ãƒã‚¤ã‚¶ & å„ç¨®è¨­å®šã‚’è¡Œã£ã¦ã„ã‚‹æœ€ä¸­ã®å‰²è¾¼ç¦æ­¢
000400 46FC 2700        95 move.w #0x2700,%SR
000404 4FF9 0000        96 lea.l SYS_STK_TOP, %SP | Set SSP
       0000             96 
                        97 ****************
                        98 ** å‰²ã‚Šè¾¼ã¿ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ã®åˆæœŸåŒ–
                        99 ****************
00040a 13FC 0040       100 move.b #0x40, IVR | ãƒ¦ãƒ¼ã‚¶å‰²ã‚Šè¾¼ã¿ãƒ™ã‚¯ã‚¿ç•ªå·ã‚’0x40+level ã«è¨­å®šï¼
       00FF F300       100 
000412 21FC 0000       101 move.l #HardwareInterface ,0x110
       0000 0110       101 
00041a 23FC 00FF       102 move.l #Mask_UART1,IMR | é€å—ä¿¡å‰²ã‚Šè¾¼ã¿è¨±å¯
       3FFB 00FF       102 
       F304            102 
                       103 ****************
                       104 ** é€å—ä¿¡ (UART1) é–¢ä¿‚ã®åˆæœŸåŒ– (å‰²ã‚Šè¾¼ã¿ãƒ¬ãƒ™ãƒ«ã¯ 4 ã«å›ºå®šã•ã‚Œã¦ã„ã‚‹)
                       105 ****************
000424 33FC 0000       106 move.w #U_Reset, USTCNT1 | ãƒªã‚»ãƒƒãƒˆ
       00FF F900       106 
00042c 33FC E10C       107 move.w #U_Pullonly, USTCNT1 |ã€€å—ä¿¡å‰²ã‚Šè¾¼ã¿è¨±å¯
       00FF F900       107 
000434 33FC 0038       108 move.w #0x0038, UBAUD1 | baud rate = 230400 bps
       00FF F902       108 
                       109 ****************
                       110 ** ã‚¿ã‚¤ãƒé–¢ä¿‚ã®åˆæœŸåŒ– (å‰²ã‚Šè¾¼ã¿ãƒ¬ãƒ™ãƒ«ã¯ 6 ã«å›ºå®šã•ã‚Œã¦ã„ã‚‹)
                       111 *****************
00043c 33FC 0004       112 move.w #0x0004, TCTL1 | restart, å‰²ã‚Šè¾¼ã¿ä¸å¯,
       00FF F600       112 
                       113 | ã‚·ã‚¹ãƒ†ãƒ ã‚¯ãƒ­ãƒƒã‚¯ã® 1/16 ã‚’å˜ä½ã¨ã—ã¦è¨ˆæ™‚ï¼Œa
                       114 | ã‚¿ã‚¤ãƒä½¿ç”¨åœæ­¢
                       115 
                       116 **ã‚­ãƒ¥ãƒ¼åˆæœŸåŒ–
000444 48E7 0080       117 	movem.l	%a0,-(%sp)	/*èµ°è¡Œãƒ¬ãƒ™ãƒ«ã®é€€é¿*/
000448 46FC 2700       118 	move.w 	#0x2700,%SR		/*å‰²ã‚Šè¾¼ã¿ç¦æ­¢(èµ°è¡Œãƒ¬ãƒ™ãƒ«7)*/
00044c 41F9 0000       119 	lea.l	top0,%a0
       0000            119 
000452 23C8 0000       120 	move.l	%a0,in0
       0000            120 
000458 23C8 0000       121 	move.l  %a0,out0
       0000            121 
00045e 23FC 0000       122 	move.l	#0,s0
       0000 0000       122 
       0000            122 
000468 41F9 0000       123 	lea.l	top1,%a0
       0000            123 
00046e 23C8 0000       124 	move.l	%a0,in1
       0000            124 
000474 23C8 0000       125 	move.l  %a0,out1
       0000            125 
00047a 23FC 0000       126 	move.l	#0,s1
       0000 0000       126 
       0000            126 
000484 4CDF 0100       127 	movem.l (%sp)+,%a0      /* èµ°è¡Œãƒ¬ãƒ™ãƒ«ã®å¾©å¸° */
                       128 **ã‚¹ã‚¿ãƒƒã‚¯ãƒ¬ã‚¸ã‚¹ã‚¿æ“ä½œ
000488 6000 0002       129 bra MAIN
                       130 ***************************************************************
                       131 **ç¾æ®µéšã§ã®åˆæœŸåŒ–ãƒ«ãƒ¼ãƒãƒ³ã®æ­£å¸¸å‹•ä½œã‚’ç¢ºèªã™ã‚‹ãŸã‚ï¼Œæœ€å¾Œã« â€™aâ€™ ã‚’
                       132 **é€ä¿¡ãƒ¬ã‚¸ã‚¹ã‚¿ UTX1 ã«æ›¸ãè¾¼ã‚€ï¼â€™aâ€™ ãŒå‡ºåŠ›ã•ã‚Œã‚Œã°ï¼ŒOK.
                       133 ***************************************************************
                       134 .section .text
                       135 .even
                       136 MAIN:
00048c 46FC 2700       137 	move.w #0x2700, %SR
000490 4EFA 0006       138 	jmp inter_put_test
000494 6000 FFF6       139 	bra MAIN
                       140 
                       141 inter_put_test:
000498 48E7 00C0       142 	movem.l %a0/%a1,-(%sp)
00049c 307C 0010       143 	move.w 	#16,%a0
0004a0 43F9 0000       144 	lea.l	ABC,%a1
       0000            144 
0004a6 0C11 0000       145 	cmp.b	#0,(%a1)
0004aa 6700 002A       146 	beq	end_program
                       147 inter_put_loop:
0004ae B0FC 0000       148 	cmp.w	#0,%a0
0004b2 6700 0010       149 	beq	to_inter_put_test
0004b6 7001            150 	move.l	#1,%d0
0004b8 1211            151 	move.b	(%a1),%d1
0004ba 5348            152 	sub.w	#1,%a0
0004bc 4EBA 0048       153 	jsr	INQ
0004c0 4EFA FFEC       154 	jmp	inter_put_loop
                       155 
                       156 to_inter_put_test:
0004c4 5289            157 	add.l	#1,%a1
0004c6 0C11 0000       158 	cmp.b   #0,(%a1)
0004ca 6700 000A       159 	beq     end_program
0004ce 307C 0010       160 	move.w	#16,%a0
0004d2 4EFA FFDA       161 	jmp	inter_put_loop
                       162 
                       163 end_program:
0004d6 2439 0000       164 	move.l	top1,%d2
       0000            164 
0004dc 23C2 0000       165 	move.l 	%d2,out1
       0000            165 
0004e2 23FC 0000       166 	move.l	#256,s1
       0100 0000       166 
       0000            166 
0004ec 46FC 2000       167 	move.w 	#0x2000,%sr		/*(èµ°è¡Œãƒ¬ãƒ™ãƒ«0)*/
0004f0 7201            168 	move.l	#1,%d1
0004f2 33FC E10C       169 	move.w	#0xE10C,USTCNT1	/*é€ä¿¡å‰²ã‚Šè¾¼ã¿è¨±å¯ã«ã—ã¦å¾©å¸°*/
       00FF F900       169 
0004fa 4CDF 0300       170 	movem.l	(%sp)+,%a0/%a1
                       171 Loop:
0004fe 4EFA FFFE       172 	jmp Loop
000502 4E72 2700       173 	stop #0x2700
                       174 
                       175 
                       176 INQ:
                       177 	**	ç•ªå·noã®ã‚­ãƒ¥ãƒ¼ã«ãƒ‡ãƒ¼ã‚¿ã‚’ã„ã‚Œã‚‹
                       178 	**	å…¥åŠ› no->d0.l	æ›¸ãè¾¼ã‚€8bitdata->d1.b
                       179 	**	å‡ºåŠ› å¤±æ•—0/æˆåŠŸ1 ->d0.l
000506 48E7 00C0       180 	movem.l	%a0/%a1,-(%sp)	/*èµ°è¡Œãƒ¬ãƒ™ãƒ«ã®é€€é¿*/
00050a 46FC 2700       181 	move.w 	#0x2700,%SR		/*å‰²ã‚Šè¾¼ã¿ç¦æ­¢(èµ°è¡Œãƒ¬ãƒ™ãƒ«7)*/
00050e 0C80 0000       182 	cmp.l 	#0,%d0			/*ã‚­ãƒ¥ãƒ¼ç•ªå·ãŒ0*/
       0000            182 
000514 6700 0010       183 	beq	INQ0
000518 0C80 0000       184 	cmp.l 	#1,%d0			/*ã‚­ãƒ¥ãƒ¼ç•ªå·ãŒ1*/
       0001            184 
00051e 6700 004A       185 	beq	INQ1
000522 4EFA 01BE       186 	jmp	Queue_fail		/*ã‚­ãƒ¥ãƒ¼ç•ªå·ãŒå­˜åœ¨ã—ãªã„*/
                       187 
                       188 	
                       189 INQ0:	
000526 0CB9 0000       190 	cmp.l	#256,s0
       0100 0000       190 
       0000            190 
000530 6700 01B0       191 	beq	Queue_fail		/*ã‚­ãƒ¥ãƒ¼ãŒæº€æ¯ã§å¤±æ•—*/
000534 2079 0000       192 	move.l	in0,%a0			
       0000            192 
00053a 1081            193 	move.b	%d1,(%a0)		/*ãƒ‡ãƒ¼ã‚¿ã‚’ã‚­ãƒ¥ãƒ¼ã«æ›¸ãè¾¼ã¿*/
00053c 43F9 0000       194 	lea.l	bottom0,%a1
       0000            194 
000542 B1C9            195 	cmp.l	%a1,%a0
000544 6700 000C       196 	beq	INQ0_step1		/*in==bottomã®ã¨ãin=top*/
000548 52B9 0000       197 	add.l	#1,in0			/*in++*/
       0000            197 
00054e 4EFA 000C       198 	jmp	INQ0_step2
                       199 
                       200 INQ0_step1:
000552 23F9 0000       201 	move.l top0,in0
       0000 0000       201 
       0000            201 
                       202 
                       203 INQ0_step2:
00055c 52B9 0000       204 	add.l	#1,s0			/*s++*/
       0000            204 
000562 7001            205 	move.l	#1,%d0			/*æˆåŠŸã‚’å ±å‘Š*/
000564 4CDF 0300       206 	movem.l (%sp)+,%a0/%a1		/*èµ°è¡Œãƒ¬ãƒ™ãƒ«ã®å›å¾©*/
000568 4E75            207 	rts
                       208 
                       209 INQ1:	
00056a 0CB9 0000       210 	cmp.l	#256,s1
       0100 0000       210 
       0000            210 
000574 6700 016C       211 	beq	Queue_fail		/*ã‚­ãƒ¥ãƒ¼ãŒæº€æ¯ã§å¤±æ•—*/
000578 2079 0000       212 	move.l	in1,%a0			
       0000            212 
00057e 1081            213 	move.b	%d1,(%a0)		/*ãƒ‡ãƒ¼ã‚¿ã‚’ã‚­ãƒ¥ãƒ¼ã«æ›¸ãè¾¼ã¿*/
000580 43F9 0000       214 	lea.l	bottom1,%a1
       0000            214 
000586 B1C9            215 	cmp.l	%a1,%a0
000588 6700 000C       216 	beq	INQ1_step1		/*in==bottomã®ã¨ãin=top*/
00058c 52B9 0000       217 	add.l	#1,in1			/*in++*/
       0000            217 
000592 4EFA 000C       218 	jmp	INQ1_step2
                       219 
                       220 INQ1_step1:
000596 23F9 0000       221 	move.l top1,in1
       0000 0000       221 
       0000            221 
                       222 
                       223 INQ1_step2:
0005a0 52B9 0000       224 	add.l	#1,s1 			/*s++*/
       0000            224 
0005a6 7001            225 	move.l	#1,%d0			/*æˆåŠŸã‚’å ±å‘Š*/
0005a8 4CDF 0300       226 	movem.l (%sp)+,%a0/%a1		/*èµ°è¡Œãƒ¬ãƒ™ãƒ«ã®å›å¾©*/
0005ac 4E75            227 	rts
                       228 
                       229 
                       230 
                       231 
                       232 /* INTERPUT(ch)ã€€ãƒãƒ£ãƒ³ãƒãƒ«chã®é€ä¿¡ã‚­ãƒ¥ãƒ¼ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’ä¸€ã¤å–ã‚Šå‡ºã—å®Ÿéš›ã«é
                       233 å…¥åŠ›ï¼šch->%D1.l */
                       234 HardwareInterface: 
0005ae 48E7 7FFF       235 	movem.l %a0-%a7/%d1-%d7, -(%sp)
0005b2 3239 00FF       236 	move.w UTX1,%d1
       F906            236 
0005b8 0241 8000       237 	andi.w #0x8000,%d1 
0005bc 0C41 8000       238 	cmp #0x8000,%d1
0005c0 6700 0008       239 	beq INTERPUT_PREPARE
0005c4 4CDF FFFE       240 	movem.l (%sp)+,%a0-%a7/%d1-%d7	
0005c8 4E73            241 	rte
                       242 INTERPUT_PREPARE:
0005ca 7200            243 	moveq #0,%d1
0005cc 4EFA 0002       244 	jmp INTERPUT
                       245 INTERPUT:
0005d0 46FC 2700       246 	move.w	#0x2700,%sr 	/*å‰²ã‚Šè¾¼ã¿ç¦æ­¢ï¼ˆèµ°è¡Œãƒ¬ãƒ™ãƒ«ã‚’ï¼—ã«è¨­å®šï¼‰*/
0005d4 0C81 0000       247 	cmp.l 	#0,%d1
       0000            247 
0005da 6600 0038       248 	bne	INTERPUT_END		/*chãŒ0ã§ãªã„ãªã‚‰ä½•ã‚‚ã›ãšã«å¾©å¸°*/
0005de 7001            249 	move.l	#1,%d0
0005e0 4EBA 0040       250 	jsr	OUTQ		/*data->%D1.b  %D0ã«çµæœã‚’æ ¼ç´*/|ã“ã“ãŒæ€ªã—ã„
0005e4 13FC 006B       251 	move.b #'k',LED4
       00D0 0029       251 
0005ec 0C80 0000       252 	cmp.l	#0,%d0
       0000            252 
0005f2 6700 0018       253 	beq	INTERPUT_fail
0005f6 13FC 0079       254 	move.b #'y',LED2
       00D0 003D       254 
0005fe 0641 0800       255 	addi.w	#0x0800,%d1
000602 33C1 00FF       256 	move.w	%d1,UTX1	/*ç¬¦å·æ‹¡å¼µã—ã¦dataã‚’UTX1ã«æ ¼ç´*/	
       F906            256 
000608 4EFA 000A       257 	jmp 	INTERPUT_END
                       258 INTERPUT_fail:
00060c 33FC E108       259 	move.w	#0xE108,USTCNT1	/*OUTQãŒå¤±æ•—ãªã‚‰é€ä¿¡å‰²ã‚Šè¾¼ã¿ç¦æ­¢ã«ã—ã¦å¾©å¸°*/
       00FF F900       259 
                       260 INTERPUT_END:
000614 4CDF FFFE       261 	movem.l (%sp)+,%a0-%a7/%d1-%d7	
000618 13FC 006F       262 	move.b #'o',LED1
       00D0 003B       262 
000620 4E73            263 	rte
                       264 OUTQ:
                       265 	**	ç•ªå·noã®ã‚­ãƒ¥ãƒ¼ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’ä¸€ã¤å–ã‚Šå‡ºã™
                       266 	**	å…¥åŠ› no->d0.l
                       267 	**	å‡ºåŠ› å¤±æ•—0/æˆåŠŸ1 ->d0.l		å–ã‚Šå‡ºã—ãŸ8bitdata ->d1.b
000622 48E7 00C0       268 	movem.l	%a0/%a1,-(%sp)	/*èµ°è¡Œãƒ¬ãƒ™ãƒ«ã®é€€é¿*/
000626 46FC 2700       269 	move.w 	#0x2700,%SR		/*å‰²ã‚Šè¾¼ã¿ç¦æ­¢(èµ°è¡Œãƒ¬ãƒ™ãƒ«7)*/
00062a 0C80 0000       270 	cmpi.l 	#0,%d0			/*ã‚­ãƒ¥ãƒ¼ç•ªå·ãŒ0*/
       0000            270 
000630 6700 0010       271 	beq	OUTQ0
000634 0C80 0000       272 	cmp.l 	#1,%d0			/*ã‚­ãƒ¥ãƒ¼ç•ªå·ãŒ1*/
       0001            272 
00063a 6700 004A       273 	beq	OUTQ1
00063e 6000 00A2       274 	bra	Queue_fail		/*ã‚­ãƒ¥ãƒ¼ç•ªå·ãŒå­˜åœ¨ã—ãªã„*/
                       275 	
                       276 
                       277 OUTQ0:	
000642 0CB9 0000       278 	cmpi.l	#0,s0
       0000 0000       278 
       0000            278 
00064c 6700 0094       279 	beq	Queue_fail		/*ã‚­ãƒ¥ãƒ¼ãŒæº€æ¯ã§å¤±æ•—*/
000650 2079 0000       280 	move.l	out0,%a0			
       0000            280 
000656 1210            281 	move.b	(%a0),%d1		/*ãƒ‡ãƒ¼ã‚¿ã‚’ã‚­ãƒ¥ãƒ¼ã‹ã‚‰å–ã‚Šå‡ºã—*/
000658 43F9 0000       282 	lea.l	bottom0,%a1
       0000            282 
00065e B1C9            283 	cmp.l	%a1,%a0
000660 6700 000C       284 	beq	OUTQ0_step1		/*out==bottomã®ã¨ãout=top*/
000664 52B9 0000       285 	add.l	#1,out0			/*out++*/
       0000            285 
00066a 6000 000C       286 	bra	OUTQ0_step2
                       287 
                       288 OUTQ0_step1:
00066e 23F9 0000       289 	move.l top0,out0
       0000 0000       289 
       0000            289 
                       290 
                       291 OUTQ0_step2:
000678 53B9 0000       292 	sub.l	#1,s0 			/*s--*/
       0000            292 
00067e 7001            293 	move.l	#1,%d0			/*æˆåŠŸã‚’å ±å‘Š*/
000680 4CDF 0300       294 	movem.l (%sp)+,%a0/%a1		/*èµ°è¡Œãƒ¬ãƒ™ãƒ«ã®å›å¾©*/
000684 4E75            295 	rts
                       296 
                       297 OUTQ1:	
000686 33FC 0001       298 	move #1,s1
       0000 0000       298 
00068e 13FC 0031       299 	move.b #'1',LED0
       00D0 0039       299 
000696 0CB9 0000       300 	cmp.l	#0,s1
       0000 0000       300 
       0000            300 
0006a0 6700 0040       301 	beq	Queue_fail		/*ã‚­ãƒ¥ãƒ¼ãŒæº€æ¯ã§å¤±æ•—*/
0006a4 2079 0000       302 	move.l	out1,%a0			
       0000            302 
0006aa 1210            303 	move.b	(%a0),%d1		/*ãƒ‡ãƒ¼ã‚¿ã‚’ã‚­ãƒ¥ãƒ¼ã‹ã‚‰å–ã‚Šå‡ºã—*/
0006ac 43F9 0000       304 	lea.l	bottom1,%a1
       0000            304 
0006b2 B1C9            305 	cmp.l	%a1,%a0
0006b4 6700 000C       306 	beq	OUTQ1_step1		/*out==bottomã®ã¨ãout=top*/
0006b8 52B9 0000       307 	add.l	#1,out1			/*out++*/
       0000            307 
0006be 6000 000C       308 	bra	OUTQ1_step2
                       309 
                       310 OUTQ1_step1:
0006c2 23F9 0000       311 	move.l top1,out1
       0000 0000       311 
       0000            311 
                       312 
                       313 OUTQ1_step2:
0006cc 53B9 0000       314 	sub.l	#1,s1 			/*s--*/
       0000            314 
0006d2 7001            315 	move.l	#1,%d0			/*æˆåŠŸã‚’å ±å‘Š*/
0006d4 13FC 0032       316 	move.b #'2',LED0
       00D0 0039       316 
0006dc 4CDF 0300       317 	movem.l (%sp)+,%a0/%a1		/*èµ°è¡Œãƒ¬ãƒ™ãƒ«ã®å›å¾©*/
0006e0 4E75            318 	rts
                       319 Queue_fail:
0006e2 13FC 0066       320 	move.b #'f',LED7
       00D0 002F       320 
0006ea 7000            321 	move.l #0,%d0			/*å¤±æ•—ã®å ±å‘Š*/
0006ec 4CDF 0300       322 	movem.l (%sp)+,%a0/%a1		/*èµ°è¡Œãƒ¬ãƒ™ãƒ«ã®å›å¾©*/
0006f0 4E75            323 	rts
                       324 
                       325 .section .data
                       326 
0006f4 6162 6364       327 ABC:	.dc.b 'a','b','c','d','e','f','g','h','i','j','k','l','m','n','o','p',0
       6566 6768       327 
       696A 6B6C       327 
       6D6E 6F70       327 
       00              327 
                       328 .end
